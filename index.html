<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Spire Weather WMS</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <link rel="shortcut icon" href="images/spire_symb_red.png">
    <!-- libraries -->
    <script src='lib/mapbox-gl-v1.5.0.js'></script>
    <link href='lib/mapbox-gl-v1.5.0.css' rel='stylesheet' />
    <script src="lib/intersection-observer-0.5.1.js"></script>
    <script src="lib/scrollama-2.2.1.js"></script>
    <!-- main app -->
    <link href='css/main.css' rel='stylesheet' />
</head>
<body>
    <a id="logo" href="https://spire.com/weather/" target="_blank" title="Spire Global"></a>
    <script>
        function afterMapLoad() {

            // var frameRate = 0.5;
            // var currentImage = 1;
             
            // function getPath() {
            //     return (
            //         './images/wms/' +
            //         currentImage +
            //         '.png'
            //     );
            // }

            // Chapter 1
            map.addSource('source1', {
                type: 'image',
                url: './images/temperature.png',
                coordinates: [
                    [-180.44902472040621, 84.21103853339332],
                    [43.18372759084186, 84.21103853339332],
                    [43.18372759084186, 18.15981671551171],
                    [-180.44902472040621, 18.15981671551171]
                ]
            });

            map.addLayer({
                id: 'layer1',
                source: 'source1',
                type: 'raster',
                paint: {
                    // initialize invisible
                    "raster-opacity": 0
                }
            });

            // Chapter 2
            map.addSource('source2', {
                type: 'image',
                url: './images/windbarbs.png',
                coordinates: [
                    [3.3227689837131686, -28.140036984046468],
                    [102.09880169662617, -28.140036984046468],
                    [102.09880169662617, -64.50414638338462],
                    [3.3227689837131686, -64.50414638338462]
                ]
            });
            map.addLayer({
                id: 'layer2',
                source: 'source2',
                type: 'raster',
                paint: {
                    // initialize invisible
                    "raster-opacity": 0
                }
            });

            // Chapter 3
            map.addSource('source3', {
                type: 'image',
                url: './images/precipitation.png',
                coordinates: [
                    [60.5302149619597, 43.202879525850165],
                    [172.20017333895348, 43.202879525850165],
                    [172.20017333895348, -20.016032253192378],
                    [60.5302149619597, -20.016032253192378]
                ]
            });
            map.addLayer({
                id: 'layer3',
                source: 'source3',
                type: 'raster',
                paint: {
                    // initialize invisible
                    "raster-opacity": 0
                }
            });

            // Chapter 4
            map.addSource('source4', {
                type: 'image',
                url: './images/relhumidity.png',
                coordinates: [
                    [-103.15970664069383, 15.605237421247793],
                    [-16.8532457794923, 15.605237421247793],
                    [-16.8532457794923, -59.10765426921901],
                    [-103.15970664069383, -59.10765426921901]
                ]
            });
            map.addLayer({
                id: 'layer4',
                source: 'source4',
                type: 'raster',
                paint: {
                    // initialize invisible
                    "raster-opacity": 0
                }
            });

            // Chapter 5
            map.addSource('source5', {
                type: 'image',
                url: './images/wms_sequence/2020-04-20_00.png',
                coordinates: [
                    [-82.09549302316059, 67.53009418142705],
                    [-23.49546798928307, 67.53009418142705],
                    [-23.49546798928307, 24.018475795878345],
                    [-82.09549302316059, 24.018475795878345]
                ]
            });
            map.addLayer({
                id: 'layer5',
                source: 'source5',
                type: 'raster',
                paint: {
                    // initialize invisible
                    "raster-opacity": 0
                }
            });


            // setInterval(function() {
            //     currentImage += 1;
            //     if (currentImage > 29) {
            //         currentImage = 1;
            //     }
            //     map.getSource('myImageSource').updateImage({ url: getPath() });
            // }, 1000 / frameRate);
        }
    </script>

    <div id="map"></div>
    <div id="story"></div>
    <script src="./config.js"></script>
    <script src="js/storytelling.js"></script>

</body>
</html>